{% extends "backend/admin_layout/base_layout.html" %}
{% load static %}
{% load humanize %}

{% block title %} Daftar Infografis {% endblock %}

{% block main %}
<div class="side-app">
  <div class="page-header">
    <div>
      <h1 class="page-title">Daftar Infografis</h1>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Infografis</a></li>
        <li class="breadcrumb-item active" aria-current="page">Daftar Infografis</li>
      </ol>
    </div>
  </div>

  <div class="row row-sm">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h3 class="card-title">Daftar Infografis</h3>
          <a href="#" data-bs-toggle="modal" data-bs-target="#modalTambahInfografis" class="btn btn-success">Tambah Infografis</a>
        </div>
        <div class="card-body">
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
          <div class="table-responsive">
            <table class="table table-bordered text-nowrap border-bottom w-100" id="responsive-datatable">
              <thead>
                <tr>
                  <th>No</th>
                  <th>Judul</th>
                  <th>Gambar</th>
                  <th>Tanggal Dibuat</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                {% for dt in infografis %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ dt.title }}</td>
                  <td>
                    <img src="{{ dt.gambar.url }}" alt="{{ dt.title }}" class="img-thumbnail" style="max-width:100px;">
                  </td>
                  <td>{{ dt.created_at|date:"d M Y" }}</td>
                  <td>
                    <!-- Edit -->
                    <a class="btn btn-primary btn-sm rounded-11 me-2" data-bs-target="#modalEditInfografis{{ dt.infografis_id }}" data-bs-toggle="modal" data-bs-original-title="Edit">
                      <i><svg class="table-edit" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="16"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM5.92 19H5v-.92l9.06-9.06.92.92L5.92 19zM20.71 5.63l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41z"/></svg></i>
                    </a>
                    <!-- Hapus -->
                    <a class="btn btn-danger btn-sm rounded-11" data-bs-toggle="modal" data-bs-target="#modalHapusInfografis{{ dt.infografis_id }}" data-bs-original-title="Delete">
                      <i><svg class="table-delete" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="16"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4h-3.5z"/></svg></i>
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Tambah Infografis -->
<div class="modal fade" id="modalTambahInfografis" tabindex="-1" aria-labelledby="modalTambahInfografisLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form action="{% url 'wisata:infografis_create' %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="modalTambahInfografisLabel">Tambah Infografis</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="title" class="form-label">Judul</label>
            <input type="text" name="title" id="title" class="form-control" required>
          </div>
          <div class="mb-3">
            <label for="gambar" class="form-label">Gambar</label>
            <input type="file" name="gambar" id="gambar" class="form-control" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Tambah</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Edit Infografis -->
{% for dt in infografis %}
<div class="modal fade" id="modalEditInfografis{{ dt.infografis_id }}" tabindex="-1" aria-labelledby="modalEditInfografisLabel{{ dt.infografis_id }}" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form action="{% url 'wisata:infografis_update' infografis_id=dt.infografis_id %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="modalEditInfografisLabel{{ dt.infografis_id }}">Edit Infografis</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="title{{ dt.infografis_id }}" class="form-label">Judul</label>
            <input type="text" name="title" id="title{{ dt.infografis_id }}" value="{{ dt.title }}" class="form-control" required>
          </div>
          <div class="mb-3">
            <label for="gambar{{ dt.infografis_id }}" class="form-label">Gambar</label>
            <input type="file" name="gambar" id="gambar{{ dt.infografis_id }}" class="form-control">
            {% if dt.gambar %}
            <img src="{{ dt.gambar.url }}" alt="Gambar" class="img-thumbnail mt-2" style="max-width:150px;">
            {% endif %}
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Simpan</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Hapus Infografis -->
<div class="modal fade" id="modalHapusInfografis{{ dt.infografis_id }}" tabindex="-1" aria-labelledby="modalHapusInfografisLabel{{ dt.infografis_id }}" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form action="{% url 'wisata:infografis_delete' infografis_id=dt.infografis_id %}" method="post">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="modalHapusInfografisLabel{{ dt.infografis_id }}">Hapus Infografis</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>Apakah Anda yakin ingin menghapus infografis "{{ dt.title }}"?</p>
          {% if dt.gambar %}
          <img src="{{ dt.gambar.url }}" alt="Gambar" class="img-thumbnail mt-2" style="max-width:150px;">
          {% endif %}
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-danger">Ya, Hapus</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endfor %}

{% endblock %} 